<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CloudPad Admin</title>

  <!-- IMPORTANT: root path -->
  <link rel="stylesheet" href="/admin.css">
  <link rel="stylesheet" href="/admin-mobile.css">
</head>
<body>

  <!-- Top Bar -->
  <div class="topbar">
    <span>CloudPad â€” Admin</span>
    <button class="logout" onclick="logout()">Logout</button>
  </div>

  <!-- Container -->
  <div class="container">

    <!-- Stats Box -->
    <div class="stats">
      <h3>Total Registered Users</h3>
      <p id="totalUsers">Loading...</p>
    </div>

    <!-- User Table -->
    <div class="table-box">
      <h3>Registered Users</h3>

      <table>
        <thead>
          <tr>
            <th>Username</th>
            <th>Role</th>
          </tr>
        </thead>
        <tbody id="userTable">
          <!-- users yaha aayenge -->
        </tbody>
      </table>
    </div>

  </div>

  <!-- ================= SCRIPTS ================= -->
  <script>
    // ðŸ” Logout
    function logout() {
      window.location.href = "/logout";
    }

    // ðŸ“Š Load total users
    fetch("/admin/stats")
      .then(res => {
        if (!res.ok) throw new Error("Not authorized");
        return res.json();
      })
      .then(data => {
        document.getElementById("totalUsers").innerText = data.totalUsers;
      })
      .catch(() => {
        document.getElementById("totalUsers").innerText = "Error";
      });

    // ðŸ‘¥ Load users list
    fetch("/admin/users")
      .then(res => {
        if (!res.ok) throw new Error("Not authorized");
        return res.json();
      })
      .then(users => {
        const table = document.getElementById("userTable");
        table.innerHTML = "";

        users.forEach(u => {
          table.innerHTML += `
            <tr>
              <td>${u.username}</td>
              <td>${u.isAdmin ? "Admin" : "User"}</td>
            </tr>
          `;
        });
      })
      .catch(err => {
        console.error(err);
        alert("Users load nahi ho rahe. Login as admin.");
      });
  </script>

</body>
</html>

